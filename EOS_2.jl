

function EOS_vf!(
    ğŸ‘‰::controls, cell::Vector{mesh.Cell}
)


    for i in cell
        Ïáµ¢ = zeros(Float64, 2, 1)
        Ïáµ¢ = zeros(Float64, 2, 1)
        Hâ‚œáµ¢ = zeros(Float64, 2, 1)
        cáµ¢ = zeros(Float64, 2, 1)
        âˆ‚Ïâˆ‚páµ¢ = zeros(Float64, 2, 1)
        âˆ‚Ïâˆ‚Táµ¢ = zeros(Float64, 2, 1)
        âˆ‚Hâ‚œâˆ‚páµ¢ = zeros(Float64, 2, 1)
        âˆ‚Hâ‚œâˆ‚Táµ¢ = zeros(Float64, 2, 1)

        i.var[ğŸ‘‰.Î±â‚] = max(min(i.var[ğŸ‘‰.Î±â‚],1.0),0.0)
        i.var[ğŸ‘‰.Î±â‚‚] = 1.0 - i.var[ğŸ‘‰.Î±â‚]

		Î±â‚ = i.var[ğŸ‘‰.Î±â‚]
		Î±â‚‚ = i.var[ğŸ‘‰.Î±â‚‚]

        j = 1
        (Ïáµ¢[j], Hâ‚œáµ¢[j], cáµ¢[j], âˆ‚Ïâˆ‚páµ¢[j], âˆ‚Ïâˆ‚Táµ¢[j], âˆ‚Hâ‚œâˆ‚páµ¢[j], âˆ‚Hâ‚œâˆ‚Táµ¢[j]) = 
        eosNASG(i.var[ğŸ‘‰.p], i.var[ğŸ‘‰.u], i.var[ğŸ‘‰.v], i.var[ğŸ‘‰.w], i.var[ğŸ‘‰.T])
        j = 2
        (Ïáµ¢[j], Hâ‚œáµ¢[j], cáµ¢[j], âˆ‚Ïâˆ‚páµ¢[j], âˆ‚Ïâˆ‚Táµ¢[j], âˆ‚Hâ‚œâˆ‚páµ¢[j], âˆ‚Hâ‚œâˆ‚Táµ¢[j]) = 
        eosIdeal(i.var[ğŸ‘‰.p], i.var[ğŸ‘‰.u], i.var[ğŸ‘‰.v], i.var[ğŸ‘‰.w], i.var[ğŸ‘‰.T])

        Ï = Î±â‚ * Ïáµ¢[1] + Î±â‚‚ * Ïáµ¢[2]

		Yâ‚ = Î±â‚*Ïáµ¢[1]/Ï
		Yâ‚‚= Î±â‚‚*Ïáµ¢[2]/Ï

        i.var[ğŸ‘‰.Yâ‚] = Ïáµ¢[1]*i.var[ğŸ‘‰.Î±â‚]/Ï
        i.var[ğŸ‘‰.Yâ‚] = max(min(i.var[ğŸ‘‰.Yâ‚],1.0),0.0)
        i.var[ğŸ‘‰.Yâ‚‚] = 1.0 - i.var[ğŸ‘‰.Yâ‚]

        i.var[ğŸ‘‰.Ï] = Ï
		
        i.var[ğŸ‘‰.Hâ‚œ] = (Î±â‚ * Ïáµ¢[1] * Hâ‚œáµ¢[1] + Î±â‚‚ * Ïáµ¢[2] * Hâ‚œáµ¢[2]) / Ï

		âˆ‚Ïâˆ‚p = Î±â‚ *âˆ‚Ïâˆ‚páµ¢[1] + Î±â‚‚ * âˆ‚Ïâˆ‚páµ¢[2]
        i.var[ğŸ‘‰.âˆ‚Ïâˆ‚p] = âˆ‚Ïâˆ‚p

		âˆ‚Ïâˆ‚T = Î±â‚ *âˆ‚Ïâˆ‚Táµ¢[1] + Î±â‚‚ * âˆ‚Ïâˆ‚Táµ¢[2]
        i.var[ğŸ‘‰.âˆ‚Ïâˆ‚T] = âˆ‚Ïâˆ‚T

		i.var[ğŸ‘‰.âˆ‚Hâ‚œâˆ‚p] = ( 
			1.0/Ï*(âˆ‚Ïâˆ‚páµ¢[1]*Î±â‚-âˆ‚Ïâˆ‚p*Yâ‚)*Hâ‚œáµ¢[1] +
			1.0/Ï*(âˆ‚Ïâˆ‚páµ¢[2]*Î±â‚‚-âˆ‚Ïâˆ‚p*Yâ‚‚)*Hâ‚œáµ¢[2] +
			Yâ‚*âˆ‚Hâ‚œâˆ‚páµ¢[1] + Yâ‚‚*âˆ‚Hâ‚œâˆ‚páµ¢[2]
		)
		#i.var[ğŸ‘‰.âˆ‚Hâ‚œâˆ‚p] += Ïáµ¢[1] * Î±â‚ * âˆ‚Hâ‚œâˆ‚páµ¢[1] + Ïáµ¢[2] * Î±â‚‚ * âˆ‚Hâ‚œâˆ‚páµ¢[2]
		#i.var[ğŸ‘‰.âˆ‚Hâ‚œâˆ‚p] -= âˆ‚Ïâˆ‚p
		#i.var[ğŸ‘‰.âˆ‚Hâ‚œâˆ‚p] /= Ï

		i.var[ğŸ‘‰.âˆ‚Hâ‚œâˆ‚T] = ( 
			1.0/Ï*(âˆ‚Ïâˆ‚Táµ¢[1]*Î±â‚-âˆ‚Ïâˆ‚T*Yâ‚)*Hâ‚œáµ¢[1] +
			1.0/Ï*(âˆ‚Ïâˆ‚Táµ¢[2]*Î±â‚‚-âˆ‚Ïâˆ‚T*Yâ‚‚)*Hâ‚œáµ¢[2] +
			Yâ‚*âˆ‚Hâ‚œâˆ‚Táµ¢[1] + Yâ‚‚*âˆ‚Hâ‚œâˆ‚Táµ¢[2]
		)

		#i.var[ğŸ‘‰.âˆ‚Hâ‚œâˆ‚T] = âˆ‚Ïâˆ‚Táµ¢[1] * Î±â‚ * Hâ‚œáµ¢[1] + âˆ‚Ïâˆ‚Táµ¢[2] * Î±â‚‚ * Hâ‚œáµ¢[2]
		#i.var[ğŸ‘‰.âˆ‚Hâ‚œâˆ‚T] += Ïáµ¢[1] * Î±â‚ * âˆ‚Hâ‚œâˆ‚Táµ¢[1] + Ïáµ¢[2] * Î±â‚‚ * âˆ‚Hâ‚œâˆ‚Táµ¢[2]
		#i.var[ğŸ‘‰.âˆ‚Hâ‚œâˆ‚T] -= âˆ‚Ïâˆ‚T
		#i.var[ğŸ‘‰.âˆ‚Hâ‚œâˆ‚T] /= Ï

        #i.var[ğŸ‘‰.âˆ‚Ïâˆ‚Yâ‚] = -Ï^2.0*(1.0/Ïáµ¢[1]-1.0/Ïáµ¢[2])
        #i.var[ğŸ‘‰.âˆ‚Hâ‚œâˆ‚Yâ‚] = Hâ‚œáµ¢[1]-Hâ‚œáµ¢[2]
        #i.var[ğŸ‘‰.âˆ‚Ïâˆ‚Yâ‚] = -Ï^2.0*(1.0/Ïáµ¢[1]-1.0/Ïáµ¢[2])
        #i.var[ğŸ‘‰.âˆ‚Hâ‚œâˆ‚Yâ‚] = Hâ‚œáµ¢[1]-Hâ‚œáµ¢[2]
        i.var[ğŸ‘‰.âˆ‚Ïâˆ‚Yâ‚] = -Ï^2.0*(1.0/Ïáµ¢[1]-1.0/Ïáµ¢[2])
        i.var[ğŸ‘‰.âˆ‚Hâ‚œâˆ‚Yâ‚] = Hâ‚œáµ¢[1]-Hâ‚œáµ¢[2]

        i.var[ğŸ‘‰.c] = i.var[ğŸ‘‰.âˆ‚Ïâˆ‚p] + 1.0/Ï*i.var[ğŸ‘‰.âˆ‚Ïâˆ‚T]/i.var[ğŸ‘‰.âˆ‚Hâ‚œâˆ‚T]*(1.0-Ï*i.var[ğŸ‘‰.âˆ‚Hâ‚œâˆ‚p])
        i.var[ğŸ‘‰.c] = âˆš(1.0/i.var[ğŸ‘‰.c])


    end


end



function faceEOS_vf!(
	p::Float64,u::Float64,v::Float64,w::Float64,T::Float64,Î±â‚::Float64
)

	Ïáµ¢ = zeros(Float64, 2, 1)
	Ïáµ¢ = zeros(Float64, 2, 1)
	Hâ‚œáµ¢ = zeros(Float64, 2, 1)
	cáµ¢ = zeros(Float64, 2, 1)
	âˆ‚Ïâˆ‚páµ¢ = zeros(Float64, 2, 1)
	âˆ‚Ïâˆ‚Táµ¢ = zeros(Float64, 2, 1)
	âˆ‚Hâ‚œâˆ‚páµ¢ = zeros(Float64, 2, 1)
	âˆ‚Hâ‚œâˆ‚Táµ¢ = zeros(Float64, 2, 1)




	Î±â‚ = max(min(Î±â‚,1.0),0.0)
	Î±â‚‚ = 1.0 - Î±â‚

	j = 1
	(Ïáµ¢[j], Hâ‚œáµ¢[j], cáµ¢[j], âˆ‚Ïâˆ‚páµ¢[j], âˆ‚Ïâˆ‚Táµ¢[j], âˆ‚Hâ‚œâˆ‚páµ¢[j], âˆ‚Hâ‚œâˆ‚Táµ¢[j]) = 
	eosNASG(p, u, v, w, T)
	j = 2
	(Ïáµ¢[j], Hâ‚œáµ¢[j], cáµ¢[j], âˆ‚Ïâˆ‚páµ¢[j], âˆ‚Ïâˆ‚Táµ¢[j], âˆ‚Hâ‚œâˆ‚páµ¢[j], âˆ‚Hâ‚œâˆ‚Táµ¢[j]) = 
	eosIdeal(p, u, v, w, T)


	

	Ï = Î±â‚ * Ïáµ¢[1] + Î±â‚‚ * Ïáµ¢[2]

	Yâ‚ = Î±â‚*Ïáµ¢[1]/Ï
	Yâ‚‚= Î±â‚‚*Ïáµ¢[2]/Ï
	
	Hâ‚œ = (Î±â‚ * Ïáµ¢[1] * Hâ‚œáµ¢[1] + Î±â‚‚ * Ïáµ¢[2] * Hâ‚œáµ¢[2]) / Ï

	âˆ‚Ïâˆ‚p = Î±â‚ *âˆ‚Ïâˆ‚páµ¢[1] + Î±â‚‚ * âˆ‚Ïâˆ‚páµ¢[2]

	âˆ‚Ïâˆ‚T = Î±â‚ *âˆ‚Ïâˆ‚Táµ¢[1] + Î±â‚‚ * âˆ‚Ïâˆ‚Táµ¢[2]

	âˆ‚Hâ‚œâˆ‚p = ( 
		1.0/Ï*(âˆ‚Ïâˆ‚páµ¢[1]*Î±â‚-âˆ‚Ïâˆ‚p*Yâ‚)*Hâ‚œáµ¢[1] +
		1.0/Ï*(âˆ‚Ïâˆ‚páµ¢[2]*Î±â‚‚-âˆ‚Ïâˆ‚p*Yâ‚‚)*Hâ‚œáµ¢[2] +
		Yâ‚*âˆ‚Hâ‚œâˆ‚páµ¢[1] + Yâ‚‚*âˆ‚Hâ‚œâˆ‚páµ¢[2]
	)
	âˆ‚Hâ‚œâˆ‚T = ( 
		1.0/Ï*(âˆ‚Ïâˆ‚Táµ¢[1]*Î±â‚-âˆ‚Ïâˆ‚T*Yâ‚)*Hâ‚œáµ¢[1] +
		1.0/Ï*(âˆ‚Ïâˆ‚Táµ¢[2]*Î±â‚‚-âˆ‚Ïâˆ‚T*Yâ‚‚)*Hâ‚œáµ¢[2] +
		Yâ‚*âˆ‚Hâ‚œâˆ‚Táµ¢[1] + Yâ‚‚*âˆ‚Hâ‚œâˆ‚Táµ¢[2]
	)

	c = âˆ‚Ïâˆ‚p + 1.0/Ï*âˆ‚Ïâˆ‚T/âˆ‚Hâ‚œâˆ‚T*(1.0-Ï*âˆ‚Hâ‚œâˆ‚p)
	c = âˆš(1.0/c)

	return Ï, Hâ‚œ, c


end




function eosIdeal(
    p, u, v, w, T
)
	uÂ² = u^2+v^2+w^2
	
	cáµ¥ = 707.0
    Î³ = 1.4
	
	câ‚š = Î³*cáµ¥
		
	# density of each phase
	Ï = 1.0/( (Î³-1.0)*cáµ¥*T/p )
	c = âˆš( Î³/Ï*p )

	# d(rho)/d(p)
	âˆ‚Ïâˆ‚p = Ï/p
	
	# d(rho)/d(T)
	âˆ‚Ïâˆ‚T = -Ï/T

	# d(h)/d(p)
	âˆ‚Hâ‚œâˆ‚p = 0.0
	# d(h)/d(T)
	âˆ‚Hâ‚œâˆ‚T = Î³*cáµ¥

	# internal energy of each phase
	# internal_energy = (p+gam*pinf)/(gam-1.0)*(1.0/rhoi-bNASG)+q

	# enthalpy of each phase
	h = Î³*cáµ¥*T

		   
	# eti = internal_energy + 0.5*usqrt
	Hâ‚œ = h + 0.5*uÂ²

	# cvi = cv
	# cpi = cp	

    return Ï, Hâ‚œ, c, âˆ‚Ïâˆ‚p, âˆ‚Ïâˆ‚T, âˆ‚Hâ‚œâˆ‚p, âˆ‚Hâ‚œâˆ‚T
end		

function eosNASG(
    p, u, v, w, T
)
	uÂ² = u^2+v^2+w^2
	
    pâˆ = 621780000.0
	cáµ¥ = 3610.0
    Î³ = 1.19
    b = 6.7212e-4
	q = -1177788.0
	
	#= 
    pâˆ = 0.0
	cáµ¥ = 3518.0
    Î³ = 1.6
    b = 0.0
	q = 0.0
	=#
	
	câ‚š = Î³*cáµ¥
		
	# density of each phase
	Ï = 1.0/( (Î³-1.0)*cáµ¥*T/(p+pâˆ)+b )
	c = âˆš( Î³/(Ï*Ï)*(p+pâˆ)/(1.0/Ï-b) )

	# d(rho)/d(p)
	âˆ‚Ïâˆ‚p = Ï*Ï*(1.0/Ï-b)/(p+pâˆ)
	
	# d(rho)/d(T)
	âˆ‚Ïâˆ‚T = -Ï*Ï*(1.0/Ï-b)/T

	# d(h)/d(p)
	âˆ‚Hâ‚œâˆ‚p = b
	# d(h)/d(T)
	âˆ‚Hâ‚œâˆ‚T = Î³*cáµ¥

	# internal energy of each phase
	# internal_energy = (p+gam*pinf)/(gam-1.0)*(1.0/rhoi-bNASG)+q

	# enthalpy of each phase
	h = Î³*cáµ¥*T + b*p + q

		   
	# eti = internal_energy + 0.5*usqrt
	Hâ‚œ = h + 0.5*uÂ²

	# cvi = cv
	# cpi = cp	

    return Ï, Hâ‚œ, c, âˆ‚Ïâˆ‚p, âˆ‚Ïâˆ‚T, âˆ‚Hâ‚œâˆ‚p, âˆ‚Hâ‚œâˆ‚T
end