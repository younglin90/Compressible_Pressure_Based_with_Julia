#= include("./module.jl")
include("./controls.jl")
using .mesh =#

function EOS!(
    ๐::controls, cell::Vector{mesh.Cell}
)


    for i in cell
        ฯแตข = zeros(Float64, 2, 1)
        ฯแตข = zeros(Float64, 2, 1)
        Hโแตข = zeros(Float64, 2, 1)
        cแตข = zeros(Float64, 2, 1)
        โฯโpแตข = zeros(Float64, 2, 1)
        โฯโTแตข = zeros(Float64, 2, 1)
        โHโโpแตข = zeros(Float64, 2, 1)
        โHโโTแตข = zeros(Float64, 2, 1)

        i.var[๐.Yโ] = max(min(i.var[๐.Yโ],1.0),0.0)
        i.var[๐.Yโ] = 1.0 - i.var[๐.Yโ]

        j = 1
        (ฯแตข[j], Hโแตข[j], cแตข[j], โฯโpแตข[j], โฯโTแตข[j], โHโโpแตข[j], โHโโTแตข[j]) = 
        eosNASG(i.var[๐.p], i.var[๐.u], i.var[๐.v], i.var[๐.w], i.var[๐.T])
        j = 2
        (ฯแตข[j], Hโแตข[j], cแตข[j], โฯโpแตข[j], โฯโTแตข[j], โHโโpแตข[j], โHโโTแตข[j]) = 
        eosIdeal(i.var[๐.p], i.var[๐.u], i.var[๐.v], i.var[๐.w], i.var[๐.T])

        ฯ = 1.0/(i.var[๐.Yโ]/ฯแตข[1]+i.var[๐.Yโ]/ฯแตข[2])

        i.var[๐.ฮฑโ] = ฯ*i.var[๐.Yโ]/ฯแตข[1]
        i.var[๐.ฮฑโ] = max(min(i.var[๐.ฮฑโ],1.0),0.0)
        i.var[๐.ฮฑโ] = 1.0 - i.var[๐.ฮฑโ]

        i.var[๐.ฯ] = ฯ
        i.var[๐.Hโ] = i.var[๐.Yโ]*Hโแตข[1] + i.var[๐.Yโ]*Hโแตข[2]

        #i.var[๐.โฯโp] = i.var[๐.ฮฑโ]*โฯโpแตข[1] + i.var[๐.ฮฑโ]*โฯโpแตข[2]
        #i.var[๐.โฯโT] = i.var[๐.ฮฑโ]*โฯโTแตข[1] + i.var[๐.ฮฑโ]*โฯโTแตข[2]
        i.var[๐.โฯโp] = 
			ฯ^2*(i.var[๐.Yโ]/ฯแตข[1]^2*โฯโpแตข[1] + 
				 i.var[๐.Yโ]/ฯแตข[2]^2*โฯโpแตข[2])
        i.var[๐.โฯโT] = 
			ฯ^2*(i.var[๐.Yโ]/ฯแตข[1]^2*โฯโTแตข[1] + 
				 i.var[๐.Yโ]/ฯแตข[2]^2*โฯโTแตข[2])

        i.var[๐.โHโโp] = i.var[๐.Yโ]*โHโโpแตข[1] + i.var[๐.Yโ]*โHโโpแตข[2]
        i.var[๐.โHโโT] = i.var[๐.Yโ]*โHโโTแตข[1] + i.var[๐.Yโ]*โHโโTแตข[2]

        i.var[๐.โฯโYโ] = -ฯ^2.0*(1.0/ฯแตข[1]-1.0/ฯแตข[2])
        i.var[๐.โHโโYโ] = Hโแตข[1]-Hโแตข[2]

        i.var[๐.c] = i.var[๐.โฯโp] + 1.0/ฯ*i.var[๐.โฯโT]/i.var[๐.โHโโT]*(1.0-ฯ*i.var[๐.โHโโp])
        i.var[๐.c] = โ(1.0/i.var[๐.c])


    end


end


function EOS_vf!(
    ๐::controls, cell::Vector{mesh.Cell}
)


    for i in cell
        ฯแตข = zeros(Float64, 2, 1)
        ฯแตข = zeros(Float64, 2, 1)
        Hโแตข = zeros(Float64, 2, 1)
        cแตข = zeros(Float64, 2, 1)
        โฯโpแตข = zeros(Float64, 2, 1)
        โฯโTแตข = zeros(Float64, 2, 1)
        โHโโpแตข = zeros(Float64, 2, 1)
        โHโโTแตข = zeros(Float64, 2, 1)

        i.var[๐.ฮฑโ] = max(min(i.var[๐.ฮฑโ],1.0),0.0)
        i.var[๐.ฮฑโ] = 1.0 - i.var[๐.ฮฑโ]

		ฮฑโ = i.var[๐.ฮฑโ]
		ฮฑโ = i.var[๐.ฮฑโ]

        j = 1
        (ฯแตข[j], Hโแตข[j], cแตข[j], โฯโpแตข[j], โฯโTแตข[j], โHโโpแตข[j], โHโโTแตข[j]) = 
        eosNASG(i.var[๐.p], i.var[๐.u], i.var[๐.v], i.var[๐.w], i.var[๐.T])
        j = 2
        (ฯแตข[j], Hโแตข[j], cแตข[j], โฯโpแตข[j], โฯโTแตข[j], โHโโpแตข[j], โHโโTแตข[j]) = 
        eosIdeal(i.var[๐.p], i.var[๐.u], i.var[๐.v], i.var[๐.w], i.var[๐.T])

        ฯ = ฮฑโ * ฯแตข[1] + ฮฑโ * ฯแตข[2]

		Yโ = ฮฑโ*ฯแตข[1]/ฯ
		Yโ= ฮฑโ*ฯแตข[2]/ฯ

        i.var[๐.Yโ] = ฯแตข[1]*i.var[๐.ฮฑโ]/ฯ
        i.var[๐.Yโ] = max(min(i.var[๐.Yโ],1.0),0.0)
        i.var[๐.Yโ] = 1.0 - i.var[๐.Yโ]

        i.var[๐.ฯ] = ฯ
		
        i.var[๐.Hโ] = (ฮฑโ * ฯแตข[1] * Hโแตข[1] + ฮฑโ * ฯแตข[2] * Hโแตข[2]) / ฯ

		โฯโp = ฮฑโ *โฯโpแตข[1] + ฮฑโ * โฯโpแตข[2]
        i.var[๐.โฯโp] = โฯโp

		โฯโT = ฮฑโ *โฯโTแตข[1] + ฮฑโ * โฯโTแตข[2]
        i.var[๐.โฯโT] = โฯโT

		i.var[๐.โHโโp] = ( 
			1.0/ฯ*(โฯโpแตข[1]*ฮฑโ-โฯโp*Yโ)*Hโแตข[1] +
			1.0/ฯ*(โฯโpแตข[2]*ฮฑโ-โฯโp*Yโ)*Hโแตข[2] +
			Yโ*โHโโpแตข[1] + Yโ*โHโโpแตข[2]
		)
		#i.var[๐.โHโโp] += ฯแตข[1] * ฮฑโ * โHโโpแตข[1] + ฯแตข[2] * ฮฑโ * โHโโpแตข[2]
		#i.var[๐.โHโโp] -= โฯโp
		#i.var[๐.โHโโp] /= ฯ

		i.var[๐.โHโโT] = ( 
			1.0/ฯ*(โฯโTแตข[1]*ฮฑโ-โฯโT*Yโ)*Hโแตข[1] +
			1.0/ฯ*(โฯโTแตข[2]*ฮฑโ-โฯโT*Yโ)*Hโแตข[2] +
			Yโ*โHโโTแตข[1] + Yโ*โHโโTแตข[2]
		)

		#i.var[๐.โHโโT] = โฯโTแตข[1] * ฮฑโ * Hโแตข[1] + โฯโTแตข[2] * ฮฑโ * Hโแตข[2]
		#i.var[๐.โHโโT] += ฯแตข[1] * ฮฑโ * โHโโTแตข[1] + ฯแตข[2] * ฮฑโ * โHโโTแตข[2]
		#i.var[๐.โHโโT] -= โฯโT
		#i.var[๐.โHโโT] /= ฯ

        #i.var[๐.โฯโYโ] = -ฯ^2.0*(1.0/ฯแตข[1]-1.0/ฯแตข[2])
        #i.var[๐.โHโโYโ] = Hโแตข[1]-Hโแตข[2]
        #i.var[๐.โฯโYโ] = -ฯ^2.0*(1.0/ฯแตข[1]-1.0/ฯแตข[2])
        #i.var[๐.โHโโYโ] = Hโแตข[1]-Hโแตข[2]
        i.var[๐.โฯโYโ] = -ฯ^2.0*(1.0/ฯแตข[1]-1.0/ฯแตข[2])
        i.var[๐.โHโโYโ] = Hโแตข[1]-Hโแตข[2]

        i.var[๐.c] = i.var[๐.โฯโp] + 1.0/ฯ*i.var[๐.โฯโT]/i.var[๐.โHโโT]*(1.0-ฯ*i.var[๐.โHโโp])
        i.var[๐.c] = โ(1.0/i.var[๐.c])


    end


end



function faceEOS!(
	p::Float64,u::Float64,v::Float64,w::Float64,T::Float64,Yโ::Float64
)


	ฯแตข = zeros(Float64, 2, 1)
	ฯแตข = zeros(Float64, 2, 1)
	Hโแตข = zeros(Float64, 2, 1)
	cแตข = zeros(Float64, 2, 1)
	โฯโpแตข = zeros(Float64, 2, 1)
	โฯโTแตข = zeros(Float64, 2, 1)
	โHโโpแตข = zeros(Float64, 2, 1)
	โHโโTแตข = zeros(Float64, 2, 1)

	Yโ = max(min(Yโ,1.0),0.0)
	Yโ = 1.0 - Yโ
	#Yโ = max(min(Yโ,1.0),0.0)
	#Yโ = 1.0 - Yโ

	j = 1
	(ฯแตข[j], Hโแตข[j], cแตข[j], โฯโpแตข[j], โฯโTแตข[j], โHโโpแตข[j], โHโโTแตข[j]) = 
	eosNASG(p, u, v, w, T)
	j = 2
	(ฯแตข[j], Hโแตข[j], cแตข[j], โฯโpแตข[j], โฯโTแตข[j], โHโโpแตข[j], โHโโTแตข[j]) = 
	eosIdeal(p, u, v, w, T)

	ฯ = 1.0/(Yโ/ฯแตข[1]+Yโ/ฯแตข[2])

	ฮฑโ = ฯ*Yโ/ฯแตข[1]
	ฮฑโ = max(min(ฮฑโ,1.0),0.0)
	ฮฑโ = 1.0 - ฮฑโ

	Hโ = Yโ*Hโแตข[1] + Yโ*Hโแตข[2]

	#โฯโp = ฮฑโ*โฯโpแตข[1] + ฮฑโ*โฯโpแตข[2]
	#โฯโT = ฮฑโ*โฯโTแตข[1] + ฮฑโ*โฯโTแตข[2]
    โฯโp = ฯ^2*(Yโ/ฯแตข[1]^2*โฯโpแตข[1] + Yโ/ฯแตข[2]^2*โฯโpแตข[2])
    โฯโT = ฯ^2*(Yโ/ฯแตข[1]^2*โฯโTแตข[1] + Yโ/ฯแตข[2]^2*โฯโTแตข[2])

	โHโโp = Yโ*โHโโpแตข[1] + Yโ*โHโโpแตข[2]
	โHโโT = Yโ*โHโโTแตข[1] + Yโ*โHโโTแตข[2]

	#โฯโYโ = -ฯ*ฯ*(1.0/ฯแตข[1]-1.0/ฯแตข[2])
	#โHโโYโ = Hโแตข[1]-Hโแตข[2]

	c = โฯโp + 1.0/ฯ*โฯโT/โHโโT*(1.0-ฯ*โHโโp)
	c = โ(1.0/c)

	return ฯ, Hโ, c


end



function faceEOS_vf!(
	p::Float64,u::Float64,v::Float64,w::Float64,T::Float64,ฮฑโ::Float64
)

	ฯแตข = zeros(Float64, 2, 1)
	ฯแตข = zeros(Float64, 2, 1)
	Hโแตข = zeros(Float64, 2, 1)
	cแตข = zeros(Float64, 2, 1)
	โฯโpแตข = zeros(Float64, 2, 1)
	โฯโTแตข = zeros(Float64, 2, 1)
	โHโโpแตข = zeros(Float64, 2, 1)
	โHโโTแตข = zeros(Float64, 2, 1)




	ฮฑโ = max(min(ฮฑโ,1.0),0.0)
	ฮฑโ = 1.0 - ฮฑโ

	j = 1
	(ฯแตข[j], Hโแตข[j], cแตข[j], โฯโpแตข[j], โฯโTแตข[j], โHโโpแตข[j], โHโโTแตข[j]) = 
	eosNASG(p, u, v, w, T)
	j = 2
	(ฯแตข[j], Hโแตข[j], cแตข[j], โฯโpแตข[j], โฯโTแตข[j], โHโโpแตข[j], โHโโTแตข[j]) = 
	eosIdeal(p, u, v, w, T)


	

	ฯ = ฮฑโ * ฯแตข[1] + ฮฑโ * ฯแตข[2]

	Yโ = ฮฑโ*ฯแตข[1]/ฯ
	Yโ= ฮฑโ*ฯแตข[2]/ฯ
	
	Hโ = (ฮฑโ * ฯแตข[1] * Hโแตข[1] + ฮฑโ * ฯแตข[2] * Hโแตข[2]) / ฯ

	โฯโp = ฮฑโ *โฯโpแตข[1] + ฮฑโ * โฯโpแตข[2]

	โฯโT = ฮฑโ *โฯโTแตข[1] + ฮฑโ * โฯโTแตข[2]

	โHโโp = ( 
		1.0/ฯ*(โฯโpแตข[1]*ฮฑโ-โฯโp*Yโ)*Hโแตข[1] +
		1.0/ฯ*(โฯโpแตข[2]*ฮฑโ-โฯโp*Yโ)*Hโแตข[2] +
		Yโ*โHโโpแตข[1] + Yโ*โHโโpแตข[2]
	)
	โHโโT = ( 
		1.0/ฯ*(โฯโTแตข[1]*ฮฑโ-โฯโT*Yโ)*Hโแตข[1] +
		1.0/ฯ*(โฯโTแตข[2]*ฮฑโ-โฯโT*Yโ)*Hโแตข[2] +
		Yโ*โHโโTแตข[1] + Yโ*โHโโTแตข[2]
	)

	c = โฯโp + 1.0/ฯ*โฯโT/โHโโT*(1.0-ฯ*โHโโp)
	c = โ(1.0/c)

	return ฯ, Hโ, c


end




function EOS_ACID(
	pโ::Float64,pแตฃ::Float64,
	uโ::Float64,uแตฃ::Float64,
	vโ::Float64,vแตฃ::Float64,
	wโ::Float64,wแตฃ::Float64,
	Tโ::Float64,Tแตฃ::Float64,
	Yโโ::Float64,Yโแตฃ::Float64
)

	ฯแตขโ = zeros(Float64, 2, 1)
	ฯแตขโ = zeros(Float64, 2, 1)
	Hโแตขโ = zeros(Float64, 2, 1)
	cแตขโ = zeros(Float64, 2, 1)
	โฯโpแตขโ = zeros(Float64, 2, 1)
	โฯโTแตขโ = zeros(Float64, 2, 1)
	โHโโpแตขโ = zeros(Float64, 2, 1)
	โHโโTแตขโ = zeros(Float64, 2, 1)
	
	ฯแตขแตฃ = zeros(Float64, 2, 1)
	ฯแตขแตฃ = zeros(Float64, 2, 1)
	Hโแตขแตฃ = zeros(Float64, 2, 1)
	cแตขแตฃ = zeros(Float64, 2, 1)
	โฯโpแตขแตฃ = zeros(Float64, 2, 1)
	โฯโTแตขแตฃ = zeros(Float64, 2, 1)
	โHโโpแตขแตฃ = zeros(Float64, 2, 1)
	โHโโTแตขแตฃ = zeros(Float64, 2, 1)

	Yโโ = 1.0 - Yโโ
	Yโแตฃ = 1.0 - Yโแตฃ

	j = 1
	(ฯแตขโ[j], Hโแตขโ[j], cแตขโ[j], โฯโpแตขโ[j], โฯโTแตขโ[j], โHโโpแตขโ[j], โHโโTแตขโ[j]) = 
	eosNASG(pโ, uโ, vโ, wโ, Tโ)
	j = 2
	(ฯแตขโ[j], Hโแตขโ[j], cแตขโ[j], โฯโpแตขโ[j], โฯโTแตขโ[j], โHโโpแตขโ[j], โHโโTแตขโ[j]) = 
	eosIdeal(pโ, uโ, vโ, wโ, Tโ)
	
	j = 1
	(ฯแตขแตฃ[j], Hโแตขแตฃ[j], cแตขแตฃ[j], โฯโpแตขแตฃ[j], โฯโTแตขแตฃ[j], โHโโpแตขแตฃ[j], โHโโTแตขแตฃ[j]) = 
	eosNASG(pแตฃ, uแตฃ, vแตฃ, wแตฃ, Tแตฃ)
	j = 2
	(ฯแตขแตฃ[j], Hโแตขแตฃ[j], cแตขแตฃ[j], โฯโpแตขแตฃ[j], โฯโTแตขแตฃ[j], โHโโpแตขแตฃ[j], โHโโTแตขแตฃ[j]) = 
	eosIdeal(pแตฃ, uแตฃ, vแตฃ, wแตฃ, Tแตฃ)

	ฯโ_ACID = 1.0/(Yโแตฃ/ฯแตขโ[1]+Yโแตฃ/ฯแตขโ[2])
	ฯแตฃ_ACID = 1.0/(Yโโ/ฯแตขแตฃ[1]+Yโโ/ฯแตขแตฃ[2])
	
    โฯโpโ_ACID = ฯโ_ACID^2*(Yโแตฃ/ฯแตขโ[1]^2*โฯโpแตขโ[1] + Yโแตฃ/ฯแตขโ[2]^2*โฯโpแตขโ[2])
    โฯโpแตฃ_ACID = ฯแตฃ_ACID^2*(Yโโ/ฯแตขแตฃ[1]^2*โฯโpแตขแตฃ[1] + Yโโ/ฯแตขแตฃ[2]^2*โฯโpแตขแตฃ[2])

	โHโโpโ_ACID = Yโแตฃ*โHโโpแตขโ[1] + Yโแตฃ*โHโโpแตขโ[2]
	โHโโpแตฃ_ACID = Yโโ*โHโโpแตขแตฃ[1] + Yโโ*โHโโpแตขแตฃ[2]
	Hโโ_ACID = Yโแตฃ*Hโแตขโ[1] + Yโแตฃ*Hโแตขโ[2]
	Hโแตฃ_ACID = Yโโ*Hโแตขแตฃ[1] + Yโโ*Hโแตขแตฃ[2]
	โฯโTโ_ACID = ฯโ_ACID^2*(Yโแตฃ/ฯแตขโ[1]^2*โฯโTแตขโ[1] + Yโแตฃ/ฯแตขโ[2]^2*โฯโTแตขโ[2])
	โฯโTแตฃ_ACID = ฯแตฃ_ACID^2*(Yโโ/ฯแตขแตฃ[1]^2*โฯโTแตขแตฃ[1] + Yโโ/ฯแตขแตฃ[2]^2*โฯโTแตขแตฃ[2])
	โHโโTโ_ACID = Yโแตฃ*โHโโTแตขโ[1] + Yโแตฃ*โHโโTแตขโ[2]
	โHโโTแตฃ_ACID = Yโโ*โHโโTแตขแตฃ[1] + Yโโ*โHโโTแตขแตฃ[2]
	
	โฯโYโโ_ACID = -ฯโ_ACID^2*(1.0/ฯแตขโ[1] + 1.0/ฯแตขโ[2])
	โฯโYโแตฃ_ACID = -ฯแตฃ_ACID^2*(1.0/ฯแตขแตฃ[1] + 1.0/ฯแตขแตฃ[2])
	#โHโโYโโ_ACID = Yโแตฃ*โHโโTแตขแตฃ[1] + Yโแตฃ*โHโโTแตขแตฃ[2]
	#โHโโYโแตฃ_ACID = Yโโ*โHโโTแตขแตฃ[1] + Yโโ*โHโโTแตขแตฃ[2]

	#Hโ = Yโ*Hโแตข[1] + Yโ*Hโแตข[2]

	#โฯโp = ฮฑโ*โฯโpแตข[1] + ฮฑโ*โฯโpแตข[2]
	#โฯโT = ฮฑโ*โฯโTแตข[1] + ฮฑโ*โฯโTแตข[2]
    #โฯโpโ_ACID = ฯ^2*(Yโ/ฯแตข[1]^2*โฯโpแตข[1] + Yโ/ฯแตข[2]^2*โฯโpแตข[2])
    #โฯโT = ฯ^2*(Yโ/ฯแตข[1]^2*โฯโTแตข[1] + Yโ/ฯแตข[2]^2*โฯโTแตข[2])

	#โHโโp = Yโ*โHโโTแตข[1] + Yโ*โHโโTแตข[2]
	#โHโโT = Yโ*โHโโTแตข[1] + Yโ*โHโโTแตข[2]

	#โฯโYโ = -ฯ*ฯ*(1.0/ฯแตข[1]-1.0/ฯแตข[2])
	#โHโโYโ = Hโแตข[1]-Hโแตข[2]

	#c = โฯโp + 1.0/ฯ*โฯโT/โHโโT*(1.0-ฯ*โHโโp)
	#c = โ(1.0/c)

	return ฯโ_ACID,ฯแตฃ_ACID,โฯโpโ_ACID,โฯโpแตฃ_ACID, โHโโpโ_ACID, โHโโpแตฃ_ACID,
	Hโโ_ACID, Hโแตฃ_ACID, โฯโTโ_ACID, โฯโTแตฃ_ACID, โHโโTโ_ACID, โHโโTแตฃ_ACID,
	โฯโYโโ_ACID, โฯโYโแตฃ_ACID


end





function EOS_ACID_vf(
	pโ::Float64,pแตฃ::Float64,
	uโ::Float64,uแตฃ::Float64,
	vโ::Float64,vแตฃ::Float64,
	wโ::Float64,wแตฃ::Float64,
	Tโ::Float64,Tแตฃ::Float64,
	ฮฑโโ::Float64,ฮฑโแตฃ::Float64
)

	ฯแตขโ = zeros(Float64, 2, 1)
	ฯแตขโ = zeros(Float64, 2, 1)
	Hโแตขโ = zeros(Float64, 2, 1)
	cแตขโ = zeros(Float64, 2, 1)
	โฯโpแตขโ = zeros(Float64, 2, 1)
	โฯโTแตขโ = zeros(Float64, 2, 1)
	โHโโpแตขโ = zeros(Float64, 2, 1)
	โHโโTแตขโ = zeros(Float64, 2, 1)
	
	ฯแตขแตฃ = zeros(Float64, 2, 1)
	ฯแตขแตฃ = zeros(Float64, 2, 1)
	Hโแตขแตฃ = zeros(Float64, 2, 1)
	cแตขแตฃ = zeros(Float64, 2, 1)
	โฯโpแตขแตฃ = zeros(Float64, 2, 1)
	โฯโTแตขแตฃ = zeros(Float64, 2, 1)
	โHโโpแตขแตฃ = zeros(Float64, 2, 1)
	โHโโTแตขแตฃ = zeros(Float64, 2, 1)

	ฮฑโโ = 1.0 - ฮฑโโ
	ฮฑโแตฃ = 1.0 - ฮฑโแตฃ

	j = 1
	(ฯแตขโ[j], Hโแตขโ[j], cแตขโ[j], โฯโpแตขโ[j], โฯโTแตขโ[j], โHโโpแตขโ[j], โHโโTแตขโ[j]) = 
	eosNASG(pโ, uโ, vโ, wโ, Tโ)
	j = 2
	(ฯแตขโ[j], Hโแตขโ[j], cแตขโ[j], โฯโpแตขโ[j], โฯโTแตขโ[j], โHโโpแตขโ[j], โHโโTแตขโ[j]) = 
	eosIdeal(pโ, uโ, vโ, wโ, Tโ)
	
	j = 1
	(ฯแตขแตฃ[j], Hโแตขแตฃ[j], cแตขแตฃ[j], โฯโpแตขแตฃ[j], โฯโTแตขแตฃ[j], โHโโpแตขแตฃ[j], โHโโTแตขแตฃ[j]) = 
	eosNASG(pแตฃ, uแตฃ, vแตฃ, wแตฃ, Tแตฃ)
	j = 2
	(ฯแตขแตฃ[j], Hโแตขแตฃ[j], cแตขแตฃ[j], โฯโpแตขแตฃ[j], โฯโTแตขแตฃ[j], โHโโpแตขแตฃ[j], โHโโTแตขแตฃ[j]) = 
	eosIdeal(pแตฃ, uแตฃ, vแตฃ, wแตฃ, Tแตฃ)

	ฯโ_ACID = ฮฑโแตฃ * ฯแตขโ[1] + ฮฑโแตฃ * ฯแตขโ[2]
	ฯแตฃ_ACID = ฮฑโโ * ฯแตขแตฃ[1] + ฮฑโโ * ฯแตขแตฃ[2]

	Yโโ = ฮฑโแตฃ * ฯแตขโ[1] / ฯโ_ACID
	Yโโ = ฮฑโแตฃ * ฯแตขโ[2] / ฯโ_ACID
	Yโแตฃ = ฮฑโโ * ฯแตขแตฃ[1] / ฯโ_ACID
	Yโแตฃ = ฮฑโโ * ฯแตขแตฃ[2] / ฯโ_ACID
	
    โฯโpโ_ACID = ฮฑโแตฃ * โฯโpแตขโ[1] + ฮฑโแตฃ * โฯโpแตขโ[2]
    โฯโpแตฃ_ACID = ฮฑโโ * โฯโpแตขแตฃ[1] + ฮฑโโ * โฯโpแตขแตฃ[2]

	Hโโ_ACID = (ฮฑโแตฃ * ฯแตขโ[1] * Hโแตขโ[1] + ฮฑโแตฃ * ฯแตขโ[2] * Hโแตขโ[2]) / ฯโ_ACID
	Hโแตฃ_ACID = (ฮฑโโ * ฯแตขแตฃ[1] * Hโแตขแตฃ[1] + ฮฑโโ * ฯแตขแตฃ[2] * Hโแตขแตฃ[2]) / ฯแตฃ_ACID

	โHโโpโ_ACID = ( 
		1.0/ฯโ_ACID*(โฯโpแตขโ[1]*ฮฑโแตฃ-โฯโpโ_ACID*Yโโ)*Hโแตขโ[1] +
		1.0/ฯโ_ACID*(โฯโpแตขโ[2]*ฮฑโแตฃ-โฯโpโ_ACID*Yโโ)*Hโแตขโ[2] +
		Yโโ*โHโโpแตขโ[1] + Yโโ*โHโโpแตขโ[2]
	)

	โHโโpแตฃ_ACID = ( 
		1.0/ฯแตฃ_ACID*(โฯโpแตขแตฃ[1]*ฮฑโโ-โฯโpแตฃ_ACID*Yโแตฃ)*Hโแตขแตฃ[1] +
		1.0/ฯแตฃ_ACID*(โฯโpแตขแตฃ[2]*ฮฑโโ-โฯโpแตฃ_ACID*Yโแตฃ)*Hโแตขแตฃ[2] +
		Yโแตฃ*โHโโpแตขแตฃ[1] + Yโแตฃ*โHโโpแตขแตฃ[2]
	)

	โฯโTโ_ACID = ฮฑโแตฃ * โฯโTแตขโ[1] + ฮฑโแตฃ * โฯโTแตขโ[2]
	โฯโTแตฃ_ACID = ฮฑโโ * โฯโTแตขแตฃ[1] + ฮฑโโ * โฯโTแตขแตฃ[2]
	
	โHโโTโ_ACID = ( 
		1.0/ฯโ_ACID*(โฯโTแตขโ[1]*ฮฑโแตฃ-โฯโTโ_ACID*Yโโ)*Hโแตขโ[1] +
		1.0/ฯโ_ACID*(โฯโTแตขโ[2]*ฮฑโแตฃ-โฯโTโ_ACID*Yโโ)*Hโแตขโ[2] +
		Yโโ*โHโโTแตขโ[1] + Yโโ*โHโโTแตขโ[2]
	)

	โHโโTแตฃ_ACID = ( 
		1.0/ฯแตฃ_ACID*(โฯโTแตขแตฃ[1]*ฮฑโโ-โฯโTแตฃ_ACID*Yโแตฃ)*Hโแตขแตฃ[1] +
		1.0/ฯแตฃ_ACID*(โฯโTแตขแตฃ[2]*ฮฑโโ-โฯโTแตฃ_ACID*Yโแตฃ)*Hโแตขแตฃ[2] +
		Yโแตฃ*โHโโTแตขแตฃ[1] + Yโแตฃ*โHโโTแตขแตฃ[2]
	)
	
	โฯโYโโ_ACID = 0.0#-ฯโ_ACID^2*(1.0/ฯแตขโ[1] + 1.0/ฯแตขโ[2])
	โฯโYโแตฃ_ACID = 0.0#-ฯแตฃ_ACID^2*(1.0/ฯแตขแตฃ[1] + 1.0/ฯแตขแตฃ[2])



	return ฯโ_ACID,ฯแตฃ_ACID,โฯโpโ_ACID,โฯโpแตฃ_ACID, โHโโpโ_ACID, โHโโpแตฃ_ACID,
	Hโโ_ACID, Hโแตฃ_ACID, โฯโTโ_ACID, โฯโTแตฃ_ACID, โHโโTโ_ACID, โHโโTแตฃ_ACID,
	โฯโYโโ_ACID, โฯโYโแตฃ_ACID


end










function eosIdeal(
    p, u, v, w, T
)
	uยฒ = u^2+v^2+w^2
	
	cแตฅ = 720.0
    ฮณ = 1.4
	
	cโ = ฮณ*cแตฅ
		
	# density of each phase
	ฯ = 1.0/( (ฮณ-1.0)*cแตฅ*T/p )
	c = โ( ฮณ/ฯ*p )

	# d(rho)/d(p)
	โฯโp = ฯ/p
	
	# d(rho)/d(T)
	โฯโT = -ฯ/T

	# d(h)/d(p)
	โHโโp = 0.0
	# d(h)/d(T)
	โHโโT = ฮณ*cแตฅ

	# internal energy of each phase
	# internal_energy = (p+gam*pinf)/(gam-1.0)*(1.0/rhoi-bNASG)+q

	# enthalpy of each phase
	h = ฮณ*cแตฅ*T

		   
	# eti = internal_energy + 0.5*usqrt
	Hโ = h + 0.5*uยฒ

	# cvi = cv
	# cpi = cp	

    return ฯ, Hโ, c, โฯโp, โฯโT, โHโโp, โHโโT
end		

function eosNASG(
    p, u, v, w, T
)
	uยฒ = u^2+v^2+w^2
	
    pโ = 621780000.0
	cแตฅ = 3610.0
    ฮณ = 1.19
    b = 6.7212e-4
	q = -1177788.0
	
	#= 
    pโ = 0.0
	cแตฅ = 3518.0
    ฮณ = 1.6
    b = 0.0
	q = 0.0
	=#
 
	#=
	# air
    pโ = 0.0
	cแตฅ = 720.0
    ฮณ = 1.4
    b = 0.0
	q = 0.0
	=#
#=
	# helium
    pโ = 0.0
	cแตฅ = 2440.12
    ฮณ = 1.648
    b = 0.0
	q = 0.0
=#
	#=

	# sod water
    pโ = 6.e8
	cแตฅ = 1569.0
    ฮณ = 4.4
    b = 0.0
	q = 0.0

	=#


	cโ = ฮณ*cแตฅ
		
	# density of each phase
	ฯ = 1.0/( (ฮณ-1.0)*cแตฅ*T/(p+pโ)+b )
	c = โ( ฮณ/(ฯ*ฯ)*(p+pโ)/(1.0/ฯ-b) )

	# d(rho)/d(p)
	โฯโp = ฯ*ฯ*(1.0/ฯ-b)/(p+pโ)
	
	# d(rho)/d(T)
	โฯโT = -ฯ*ฯ*(1.0/ฯ-b)/T

	# d(h)/d(p)
	โHโโp = b
	# d(h)/d(T)
	โHโโT = ฮณ*cแตฅ

	# internal energy of each phase
	# internal_energy = (p+gam*pinf)/(gam-1.0)*(1.0/rhoi-bNASG)+q

	# enthalpy of each phase
	h = ฮณ*cแตฅ*T + b*p + q

		   
	# eti = internal_energy + 0.5*usqrt
	Hโ = h + 0.5*uยฒ

	# cvi = cv
	# cpi = cp	

    return ฯ, Hโ, c, โฯโp, โฯโT, โHโโp, โHโโT
end